'use strict';var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();Object.defineProperty(exports,'__esModule',{value:!0});function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var defaultOptions={virtualPageViewEvent:'virtual_pageview',startPush:{experiements:[]},addExperiments:[]},TagManager=function(){function a(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:defaultOptions;_classCallCheck(this,a),this.options=Object.assign(defaultOptions,c),this.dataLayer=b||[],this.setupExperiments(),this.dataLayer.push(this.options.startPush)}return _createClass(a,[{key:'setupExperiments',value:function setupExperiments(){return Object.assign(this.options.startPush,{experiments:this.experiments()}),this}},{key:'experiments',value:function experiments(){return this.options.startPush.experiments=[this.options.startPush.experiments].concat(_toConsumableArray(this.options.addExperiments)),this.options.startPush.experiments}},{key:'prependExperiment',value:function prependExperiment(a){if(this.dataLayer[0].experiments){var b=Object.assign({},this.options.startPush,{experiments:[a]});return this.dataLayer[0].experiments=[b].concat(_toConsumableArray(this.dataLayer[0].experiments)),this.dataLayer[0].experiments}return this.dataLayer[0].experiments.push(a)}},{key:'virtualPageView',value:function virtualPageView(a,b){this.dataLayer.push({vpname:a,event:b||this.options.virtualPageViewEvent})}},{key:'eventCategory',value:function eventCategory(a,b){var c=Object.assign({eventCategory:a,event:'GAEvent'},b||{});return this.dataLayer.push(c)}},{key:'custom',value:function custom(a){return this.dataLayer.push(a)}},{key:'bindEvents',value:function bindEvents(){var a=document.querySelectorAll('[data-gtm-event="ga-event"]');return a.forEach(function(a){a.getAttribute('data-gtm-bind')||(a.addEventListener('click',this.clickGAEvent.bind(this)),a.setAttribute('data-gtm-binded',!0))},this),a}},{key:'clickGAEvent',value:function clickGAEvent(a){var b=a.getAttribute('data-gtm-category'),c=a.getAttribute('data-gtm-action')||null,d=a.getAttribute('data-gtm-label')||null,e=a.getAttribute('data-gtm-value')||null,f=a.getAttribute('data-gtm-property')||null;this.eventCategory(b,{eventAction:c,eventLabel:d,eventValue:e,eventProperty:f})}}]),a}();exports.default=TagManager;
